{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature inlet.*\"} > 45 or DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature inlet.*\"} < 18",
        "hide": true,
        "iconColor": "red",
        "name": "Coolant inlet critical",
        "textFormat": "Critical",
        "titleFormat": "Coolant inlet temp"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "(DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature inlet.*\"} > 40 and DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature inlet.*\"} <= 45) or (DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature inlet.*\"} >= 18 and DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature inlet.*\"} < 22)",
        "hide": true,
        "iconColor": "yellow",
        "name": "Coolant inlet warning",
        "textFormat": "Warning",
        "titleFormat": "Coolant inlet temp"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature outlet.*\"} > 65",
        "hide": true,
        "iconColor": "red",
        "name": "Coolant outlet critical",
        "textFormat": "Critical",
        "titleFormat": "Coolant outlet temp"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature outlet.*\"} > 60 and DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature outlet.*\"} <= 65",
        "hide": true,
        "iconColor": "yellow",
        "name": "Coolant outlet warning",
        "textFormat": "Warning",
        "titleFormat": "Coolant outlet temp"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant deltaT.*\"} > 20",
        "hide": true,
        "iconColor": "red",
        "name": "Coolant deltaT critical",
        "textFormat": "Critical",
        "titleFormat": "Coolant deltaT"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant deltaT.*\"} > 15 and DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant deltaT.*\"} <= 20",
        "hide": true,
        "iconColor": "yellow",
        "name": "Coolant deltaT warning",
        "textFormat": "Warning",
        "titleFormat": "Coolant deltaT"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Coolant level\"} == 0",
        "hide": true,
        "iconColor": "red",
        "name": "Coolant level critical",
        "textFormat": "Critical - LOW",
        "titleFormat": "Coolant level"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"LEAK detection\"} == 1",
        "hide": true,
        "iconColor": "red",
        "name": "Coolant leak critical",
        "textFormat": "Critical - LEAKED",
        "titleFormat": "Coolant leakage"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air temperature\"} > 50",
        "hide": true,
        "iconColor": "red",
        "name": "Chassis temp critical",
        "textFormat": "Critical",
        "titleFormat": "Chassis temperature"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air temperature\"} > 40 and DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air temperature\"} <= 50",
        "hide": true,
        "iconColor": "yellow",
        "name": "Chassis temp warning",
        "textFormat": "Warning",
        "titleFormat": "Chassis temperature"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air humidity\"} > 80 or DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air humidity\"} < 10",
        "hide": true,
        "iconColor": "red",
        "name": "Chassis humidity critical",
        "textFormat": "Critical",
        "titleFormat": "Chassis humidity"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "(DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air humidity\"} > 60 and DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air humidity\"} <= 80) or (DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air humidity\"} >= 10 and DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air humidity\"} < 20)",
        "hide": true,
        "iconColor": "yellow",
        "name": "Chassis humidity warning",
        "textFormat": "Warning",
        "titleFormat": "Chassis humidity"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\".*asic temperature\"} > 90",
        "hide": true,
        "iconColor": "red",
        "name": "AI processor temp critical",
        "textFormat": "Critical",
        "titleFormat": "AI processor temperature"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\".*asic temperature\"} > 75 and DLC_sensors_gauge{server_name=\"dg5R\", metric=~\".*asic temperature\"} <= 90",
        "hide": true,
        "iconColor": "yellow",
        "name": "AI processor temp warning",
        "textFormat": "Warning",
        "titleFormat": "AI processor temperature"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"CPU[0-9]+ temperature\"} > 95",
        "hide": true,
        "iconColor": "red",
        "name": "CPU temp critical",
        "textFormat": "Critical",
        "titleFormat": "CPU temperature"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"CPU[0-9]+ temperature\"} > 85 and DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"CPU[0-9]+ temperature\"} <= 95",
        "hide": true,
        "iconColor": "yellow",
        "name": "CPU temp warning",
        "textFormat": "Warning",
        "titleFormat": "CPU temperature"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"OOM_count\"} >= 1",
        "hide": true,
        "iconColor": "red",
        "name": "OOM critical",
        "textFormat": "Critical",
        "titleFormat": "Out of Memory"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Network link status\"} == 0",
        "hide": true,
        "iconColor": "red",
        "name": "Network link down",
        "textFormat": "Critical - DOWN",
        "titleFormat": "Network link"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Network drops rate\"} >= 0.05",
        "hide": true,
        "iconColor": "red",
        "name": "Network drops critical",
        "textFormat": "Critical",
        "titleFormat": "Network drops"
      },
      {
        "datasource": {
          "type": "prometheus",
          "uid": "${datasource}"
        },
        "enable": true,
        "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Network drops rate\"} > 0.01 and DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Network drops rate\"} < 0.05",
        "hide": true,
        "iconColor": "yellow",
        "name": "Network drops warning",
        "textFormat": "Warning",
        "titleFormat": "Network drops"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "panels": [],
      "title": "System Summary",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "gridPos": {
        "h": 12,
        "w": 18,
        "x": 0,
        "y": 1
      },
      "id": 2,
      "options": {
        "SVGBaseFix": true,
        "add100Percentage": true,
        "centerAlignContent": false,
        "overflow": "auto",
        "css": "* { box-sizing: border-box; margin: 0; padding: 0; }\n.overview { width: 100%; height: 100%; padding: 12px; display: flex; flex-direction: column; gap: 8px; border-radius: 8px; font-family: Inter, sans-serif; }\n.overview.normal { border: 2px solid #37872d; }\n.overview.warning { border: 2px solid #e5ac0e; }\n.overview.critical { border: 2px solid #c4162a; }\n.status-bar { display: flex; justify-content: space-between; align-items: center; padding: 8px 14px; border-radius: 4px; color: white; font-weight: 700; font-size: 16px; }\n.status-bar.normal { background: #37872d; }\n.status-bar.warning { background: #e5ac0e; color: #000; }\n.status-bar.critical { background: #c4162a; }\n.sections { display: flex; gap: 8px; flex: 1; min-height: 0; }\n.section { flex: 1; background: rgba(255,255,255,0.04); border-radius: 6px; padding: 10px; overflow-y: auto; }\n.section.wide { flex: 2; }\n.section h4 { font-size: 13px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; opacity: 0.6; color: #fff; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 5px; }\n.cols { display: flex; gap: 16px; }\n.cols > div { flex: 1; }\n.mr { display: flex; justify-content: space-between; padding: 4px 0; font-size: 13px; color: #fff; }\n.mr .lb { opacity: 0.7; }\n.mr .vl { font-weight: 600; font-variant-numeric: tabular-nums; }\n.vl.normal { color: #fff; }\n.vl.warning { color: #FADE2A; }\n.vl.critical { color: #F2495C; }\n.sub { font-size: 12px; color: #fff; opacity: 0.6; margin-top: 8px; margin-bottom: 4px; font-weight: 600; }",
        "html": "<div class='overview normal' id='ov'>\n  <div class='status-bar normal' id='sb'><span>dg5R Server</span><span id='st'>Normal</span></div>\n  <div class='sections'>\n    <div class='section'>\n      <h4>Cooling Health</h4>\n      <div class='sub'>Loop 1</div>\n      <div class='mr'><span class='lb'>Inlet 1</span><span class='vl' id='v-inlet1'>-</span></div>\n      <div class='mr'><span class='lb'>Outlet 1</span><span class='vl' id='v-outlet1'>-</span></div>\n      <div class='sub'>Loop 2</div>\n      <div class='mr'><span class='lb'>Inlet 2</span><span class='vl' id='v-inlet2'>-</span></div>\n      <div class='mr'><span class='lb'>Outlet 2</span><span class='vl' id='v-outlet2'>-</span></div>\n      <div class='mr'><span class='lb'>Coolant Level</span><span class='vl' id='v-level'>-</span></div>\n      <div class='mr'><span class='lb'>Leakage</span><span class='vl' id='v-leak'>-</span></div>\n      <div class='mr'><span class='lb'>Chassis Temp</span><span class='vl' id='v-ctemp'>-</span></div>\n      <div class='mr'><span class='lb'>Chassis Humidity</span><span class='vl' id='v-chumid'>-</span></div>\n    </div>\n    <div class='section wide'>\n      <h4>Compute Health</h4>\n      <div class='cols'>\n        <div>\n          <div class='sub'>AI Processors (avg)</div>\n          <div class='mr'><span class='lb'>Temperature</span><span class='vl' id='v-gpu-temp'>-</span></div>\n          <div class='mr'><span class='lb'>Power</span><span class='vl' id='v-gpu-pwr'>-</span></div>\n          <div class='mr'><span class='lb'>Mem Util</span><span class='vl' id='v-gpu-mem'>-</span></div>\n          <div class='mr'><span class='lb'>Core Util</span><span class='vl' id='v-gpu-core'>-</span></div>\n          <div class='sub'>Memory</div>\n          <div class='mr'><span class='lb'>Available</span><span class='vl' id='v-mem-avail'>-</span></div>\n          <div class='mr'><span class='lb'>Swap Usage</span><span class='vl' id='v-swap'>-</span></div>\n          <div class='mr'><span class='lb'>OOM</span><span class='vl' id='v-oom'>-</span></div>\n        </div>\n        <div>\n          <div class='sub'>CPUs (avg)</div>\n          <div class='mr'><span class='lb'>Temperature</span><span class='vl' id='v-cpu-temp'>-</span></div>\n          <div class='mr'><span class='lb'>Power</span><span class='vl' id='v-cpu-pwr'>-</span></div>\n          <div class='mr'><span class='lb'>CPU Util</span><span class='vl' id='v-cpu-util'>-</span></div>\n        </div>\n      </div>\n    </div>\n    <div class='section'>\n      <h4>Network Health</h4>\n      <div class='mr'><span class='lb'>Link Status</span><span class='vl' id='v-link'>-</span></div>\n      <div class='mr'><span class='lb'>TX Throughput</span><span class='vl' id='v-tx'>-</span></div>\n      <div class='mr'><span class='lb'>RX Throughput</span><span class='vl' id='v-rx'>-</span></div>\n      <div class='mr'><span class='lb'>Error Rate</span><span class='vl' id='v-err'>-</span></div>\n      <div class='mr'><span class='lb'>Drop Rate</span><span class='vl' id='v-drop'>-</span></div>\n    </div>\n  </div>\n</div>",
        "onRender": "const m={};\ndata.series.forEach(s=>{\n  if(!s.fields||s.fields.length<2)return;\n  const f=s.fields[1];\n  const metric=(f.labels||{}).metric||'';\n  const vals=f.values;\n  if(vals&&vals.length>0) m[metric]=vals[vals.length-1];\n});\n\nfunction fmt(v,u,d){return v!==undefined&&v!==null?v.toFixed(d!==undefined?d:1)+u:'-';}\nfunction el(id){return htmlNode.querySelector('#'+id);}\nfunction setV(id,text,cls){\n  const e=el(id); if(!e)return;\n  e.textContent=text;\n  e.className='vl '+(cls||'normal');\n}\n\nfunction evalInlet(v){if(v===undefined)return'normal';if(v>45||v<18)return'critical';if(v>40||v<22)return'warning';return'normal';}\nfunction evalOutlet(v){if(v===undefined)return'normal';if(v>65)return'critical';if(v>60)return'warning';return'normal';}\nfunction evalChasT(v){if(v===undefined)return'normal';if(v>50)return'critical';if(v>40)return'warning';return'normal';}\nfunction evalChasH(v){if(v===undefined)return'normal';if(v>80||v<10)return'critical';if(v>60||v<20)return'warning';return'normal';}\nfunction evalGpuT(v){if(v===undefined)return'normal';if(v>90)return'critical';if(v>75)return'warning';return'normal';}\nfunction evalCpuT(v){if(v===undefined)return'normal';if(v>95)return'critical';if(v>85)return'warning';return'normal';}\nfunction evalMemAvail(total,avail){if(!total||!avail)return'normal';const p=avail/total*100;if(p<10)return'critical';if(p<20)return'warning';return'normal';}\nfunction evalSwap(v){if(v===undefined)return'normal';if(v>0)return'warning';return'normal';}\nfunction evalOom(v){if(v===undefined)return'normal';if(v>=1)return'critical';return'normal';}\nfunction evalLink(v){if(v===undefined)return'normal';if(v===0)return'critical';return'normal';}\nfunction evalDrop(v){if(v===undefined)return'normal';if(v>=0.05)return'critical';if(v>0.01)return'warning';return'normal';}\n\nconst sts=[];\nconst i1=m['Coolant temperature inlet1'],i2=m['Coolant temperature inlet2'];\nconst o1=m['Coolant temperature outlet1'],o2=m['Coolant temperature outlet2'];\nconst lv=m['Coolant level'],lk=m['LEAK detection'];\nconst ct=m['Air temperature'],ch=m['Air humidity'];\n\nlet s;\ns=evalInlet(i1);sts.push(s);setV('v-inlet1',fmt(i1,'\\u00b0C'),s);\ns=evalInlet(i2);sts.push(s);setV('v-inlet2',fmt(i2,'\\u00b0C'),s);\ns=evalOutlet(o1);sts.push(s);setV('v-outlet1',fmt(o1,'\\u00b0C'),s);\ns=evalOutlet(o2);sts.push(s);setV('v-outlet2',fmt(o2,'\\u00b0C'),s);\ns=lv===0?'critical':'normal';sts.push(s);setV('v-level',lv===1?'HIGH':'LOW',s);\ns=lk===1?'critical':'normal';sts.push(s);setV('v-leak',lk===1?'LEAKED':'NORMAL',s);\ns=evalChasT(ct);sts.push(s);setV('v-ctemp',fmt(ct,'\\u00b0C'),s);\ns=evalChasH(ch);sts.push(s);setV('v-chumid',fmt(ch,'%'),s);\n\nconst gpuTs=[],gpuPs=[],gpuMs=[],gpuCs=[];\nObject.keys(m).forEach(k=>{\n  if(k.includes('asic temperature'))gpuTs.push(m[k]);\n  if(k.includes('current power usage'))gpuPs.push(m[k]);\n  if(k.includes('memory utilization'))gpuMs.push(m[k]);\n  if(k.includes('core utilization'))gpuCs.push(m[k]);\n});\nfunction avg(a){return a.length?a.reduce((s,v)=>s+v,0)/a.length:undefined;}\nconst gaT=avg(gpuTs),gaP=avg(gpuPs),gaM=avg(gpuMs),gaC=avg(gpuCs);\ns=evalGpuT(gaT);sts.push(s);setV('v-gpu-temp',fmt(gaT,'\\u00b0C'),s);\nsetV('v-gpu-pwr',fmt(gaP,'W'),'normal');\nsetV('v-gpu-mem',fmt(gaM,'%'),'normal');\nsetV('v-gpu-core',fmt(gaC,'%'),'normal');\n\nconst cpuTs=[],cpuPs=[];\nObject.keys(m).forEach(k=>{\n  if(k.match(/^CPU\\d+ temperature$/))cpuTs.push(m[k]);\n  if(k.match(/^CPU\\d+ power usage$/))cpuPs.push(m[k]);\n});\nconst caT=avg(cpuTs),caP=avg(cpuPs),cuU=m['CPU Usage'];\ns=evalCpuT(caT);sts.push(s);setV('v-cpu-temp',fmt(caT,'\\u00b0C'),s);\nsetV('v-cpu-pwr',fmt(caP,'W'),'normal');\nsetV('v-cpu-util',fmt(cuU,'%'),'normal');\n\nconst mT=m['Memory_total'],mA=m['Memory_available'],sw=m['Swap_usage'],oom=m['OOM_count'];\ns=evalMemAvail(mT,mA);sts.push(s);setV('v-mem-avail',mT&&mA?((mA/mT*100).toFixed(1)+'%'):'-',s);\ns=evalSwap(sw);sts.push(s);setV('v-swap',fmt(sw,' GB'),s);\ns=evalOom(oom);sts.push(s);setV('v-oom',oom!==undefined?oom.toString():'-',s);\n\nconst nl=m['Network link status'],ntx=m['Network TX throughput'],nrx=m['Network RX throughput'];\nconst ne=m['Network errors rate'],nd=m['Network drops rate'];\ns=evalLink(nl);sts.push(s);setV('v-link',nl===1?'UP':'DOWN',s);\nsetV('v-tx',fmt(ntx,' Gbps'),'normal');\nsetV('v-rx',fmt(nrx,' Gbps'),'normal');\nsetV('v-err',fmt(ne,'%'),'normal');\ns=evalDrop(nd);sts.push(s);setV('v-drop',fmt(nd,'%'),s);\n\nlet worst='normal';\nsts.forEach(v=>{if(v==='critical')worst='critical';else if(v==='warning'&&worst!=='critical')worst='warning';});\nconst ov=el('ov');if(ov)ov.className='overview '+worst;\nconst sb=el('sb');if(sb)sb.className='status-bar '+worst;\nconst stEl=el('st');if(stEl)stEl.textContent=worst==='critical'?'Critical':worst==='warning'?'Warning':'Normal';",
        "onInit": ""
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\"}",
          "instant": true,
          "legendFormat": "{{metric}}",
          "refId": "A"
        }
      ],
      "title": "Server Overview",
      "type": "gapit-htmlgraphics-panel"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "gridPos": {
        "h": 12,
        "w": 6,
        "x": 18,
        "y": 1
      },
      "id": 3,
      "options": {
        "alertInstanceLabelFilter": "",
        "alertName": "",
        "dashboardAlerts": false,
        "groupBy": [],
        "groupMode": "default",
        "maxItems": 20,
        "sortOrder": 1,
        "stateFilter": {
          "error": true,
          "firing": true,
          "noData": false,
          "normal": false,
          "pending": true
        },
        "viewMode": "list"
      },
      "pluginVersion": "12.3.3",
      "title": "Alert List",
      "type": "alertlist"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 13
      },
      "id": 4,
      "panels": [],
      "title": "Detailed",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "gridPos": {
        "h": 20,
        "w": 7,
        "x": 0,
        "y": 14
      },
      "id": 5,
      "options": {
        "SVGBaseFix": true,
        "add100Percentage": true,
        "centerAlignContent": false,
        "overflow": "hidden",
        "css": "* { box-sizing: border-box; margin: 0; padding: 0; }\n.cool { width: 100%; height: 100%; padding: 2px; font-family: Inter, sans-serif; color: #fff; display: flex; flex-direction: column; }\n.diagram { flex: 1; position: relative; min-height: 0; }\nsvg { width: 100%; height: 100%; }\n.sv { font-size: 8px; font-weight: 700; font-family: monospace; }\n.sv.normal { fill: #fff; }\n.sv.warning { fill: #FADE2A; }\n.sv.critical { fill: #F2495C; }\n.cl { font-size: 8px; fill: #fff; font-weight: 600; }\n.cl-sm { font-size: 6.5px; fill: rgba(255,255,255,0.5); font-weight: 400; }\n.cb { fill: rgba(255,255,255,0.06); stroke: rgba(255,255,255,0.25); stroke-width: 1; rx: 4; }\n@keyframes flowDown { from { stroke-dashoffset: 8; } to { stroke-dashoffset: 0; } }\n@keyframes flowUp { from { stroke-dashoffset: 0; } to { stroke-dashoffset: 8; } }\n.pipe-cold { stroke: #4A9BF5; stroke-width: 2; fill: none; stroke-dasharray: 4 4; animation: flowDown 0.8s linear infinite; }\n.pipe-hot { stroke: #F2495C; stroke-width: 2; fill: none; stroke-dasharray: 4 4; animation: flowUp 0.8s linear infinite; }\n.sep { stroke: rgba(255,255,255,0.15); stroke-width: 1; }",
        "html": "<div class='cool'>\n<div class='diagram'>\n<svg viewBox='0 0 260 340' xmlns='http://www.w3.org/2000/svg'>\n  <defs>\n    <linearGradient id='gCold' x1='0' y1='0' x2='0' y2='1'>\n      <stop offset='0%' stop-color='rgba(74,155,245,0.12)'/>\n      <stop offset='100%' stop-color='rgba(74,155,245,0.03)'/>\n    </linearGradient>\n    <linearGradient id='gHot' x1='0' y1='0' x2='0' y2='1'>\n      <stop offset='0%' stop-color='rgba(242,73,92,0.12)'/>\n      <stop offset='100%' stop-color='rgba(242,73,92,0.03)'/>\n    </linearGradient>\n  </defs>\n\n  <!-- Fan + Radiator -->\n  <rect x='25' y='6' width='210' height='22' fill='url(#gCold)' stroke='rgba(74,155,245,0.3)' stroke-width='1' rx='4'/>\n  <text class='cl' x='130' y='20' text-anchor='middle'>Fan + Radiator</text>\n  <text class='cl-sm' x='230' y='14'>❁</text>\n\n  <path class='pipe-cold' d='M90,28 L90,36'/>\n  <path class='pipe-cold' d='M170,28 L170,36'/>\n\n  <!-- Reservoir + Coolant Level -->\n  <rect x='25' y='36' width='210' height='28' fill='url(#gCold)' stroke='rgba(74,155,245,0.3)' stroke-width='1' rx='4'/>\n  <text class='cl' x='130' y='49' text-anchor='middle'>Reservoir</text>\n  <text class='sv normal' id='sv-lev' x='130' y='60' text-anchor='middle'>Coolant Level: -</text>\n  <text class='cl-sm' x='230' y='49'>❀</text>\n\n  <path class='pipe-cold' d='M90,64 L90,72'/>\n  <path class='pipe-cold' d='M170,64 L170,72'/>\n\n  <!-- Pumps -->\n  <rect class='cb' x='25' y='72' width='100' height='18'/>\n  <text class='cl' x='75' y='84' text-anchor='middle'>Pump</text>\n  <rect class='cb' x='135' y='72' width='100' height='18'/>\n  <text class='cl' x='185' y='84' text-anchor='middle'>Pump</text>\n\n  <path class='pipe-cold' d='M90,90 L90,98'/>\n  <path class='pipe-cold' d='M170,90 L170,98'/>\n\n  <!-- Coolant Inlet Manifold -->\n  <rect x='25' y='98' width='210' height='32' fill='url(#gCold)' stroke='rgba(74,155,245,0.3)' stroke-width='1' rx='4'/>\n  <text class='cl' x='130' y='110' text-anchor='middle'>Coolant Inlet Manifold</text>\n  <line x1='130' y1='112' x2='130' y2='128' stroke='rgba(255,255,255,0.25)' stroke-width='1' stroke-dasharray='3,2'/>\n  <text class='sv normal' id='sv-in1' x='78' y='125' text-anchor='middle'>Inlet 1: -</text>\n  <text class='sv normal' id='sv-in2' x='182' y='125' text-anchor='middle'>Inlet 2: -</text>\n\n  <path class='pipe-cold' d='M90,130 L90,138'/>\n  <path class='pipe-cold' d='M170,130 L170,138'/>\n\n  <!-- Heat Source -->\n  <rect x='25' y='138' width='210' height='28' fill='url(#gHot)' stroke='rgba(242,73,92,0.3)' stroke-width='1' rx='4'/>\n  <text class='cl' x='130' y='152' text-anchor='middle'>Heat Source</text>\n  <text class='cl-sm' x='130' y='162' text-anchor='middle'>(CPU / AI Processor / NIC)</text>\n\n  <path class='pipe-hot' d='M90,166 L90,174'/>\n  <path class='pipe-hot' d='M170,166 L170,174'/>\n\n  <!-- Coolant Outlet Manifold -->\n  <rect x='25' y='174' width='210' height='32' fill='url(#gHot)' stroke='rgba(242,73,92,0.3)' stroke-width='1' rx='4'/>\n  <text class='cl' x='130' y='186' text-anchor='middle'>Coolant Outlet Manifold</text>\n  <line x1='130' y1='188' x2='130' y2='204' stroke='rgba(255,255,255,0.25)' stroke-width='1' stroke-dasharray='3,2'/>\n  <text class='sv normal' id='sv-out1' x='78' y='201' text-anchor='middle'>Outlet 1: -</text>\n  <text class='sv normal' id='sv-out2' x='182' y='201' text-anchor='middle'>Outlet 2: -</text>\n\n  <!-- Return pipes -->\n  <path class='pipe-hot' d='M38,206 L38,218 L16,218 L16,17 L25,17'/>\n  <path class='pipe-hot' d='M222,206 L222,218 L244,218 L244,17 L235,17'/>\n\n  <!-- Separator -->\n  <line class='sep' x1='25' y1='230' x2='235' y2='230'/>\n\n  <!-- Status Section -->\n  <text class='cl' x='28' y='248'>Coolant ΔT1</text>\n  <text class='sv normal' id='sv-dt1' x='232' y='248' text-anchor='end'>-</text>\n\n  <text class='cl' x='28' y='264'>Coolant ΔT2</text>\n  <text class='sv normal' id='sv-dt2' x='232' y='264' text-anchor='end'>-</text>\n\n  <text class='cl' x='28' y='280'>Leak Detection</text>\n  <text class='sv normal' id='sv-leak' x='232' y='280' text-anchor='end'>-</text>\n\n  <text class='cl' x='28' y='296'>Chassis Temp</text>\n  <text class='sv normal' id='sv-ct' x='232' y='296' text-anchor='end'>-</text>\n\n  <text class='cl' x='28' y='312'>Chassis Humidity</text>\n  <text class='sv normal' id='sv-ch' x='232' y='312' text-anchor='end'>-</text>\n\n</svg>\n</div>\n</div>",
        "onRender": "const m={};\ndata.series.forEach(s=>{\n  if(!s.fields||s.fields.length<2)return;\n  const f=s.fields[1];\n  const metric=(f.labels||{}).metric||'';\n  const vals=f.values;\n  if(vals&&vals.length>0) m[metric]=vals[vals.length-1];\n});\n\nfunction fmt(v,d){return v!==undefined&&v!==null?v.toFixed(d!==undefined?d:1):'-';}\nfunction cls(st){return 'sv '+st;}\nfunction evalInlet(v){if(v===undefined)return'normal';if(v>45||v<18)return'critical';if(v>40||v<22)return'warning';return'normal';}\nfunction evalOutlet(v){if(v===undefined)return'normal';if(v>65)return'critical';if(v>60)return'warning';return'normal';}\nfunction evalDelta(v){if(v===undefined)return'normal';if(v>20)return'critical';if(v>15)return'warning';return'normal';}\nfunction evalChasT(v){if(v===undefined)return'normal';if(v>50)return'critical';if(v>40)return'warning';return'normal';}\nfunction evalChasH(v){if(v===undefined)return'normal';if(v>80||v<10)return'critical';if(v>60||v<20)return'warning';return'normal';}\n\nfunction setEl(id,text,status){\n  const e=htmlNode.querySelector('#'+id);if(!e)return;\n  e.textContent=text;\n  e.setAttribute('class',cls(status));\n}\n\nconst i1=m['Coolant temperature inlet1'],i2=m['Coolant temperature inlet2'];\nconst o1=m['Coolant temperature outlet1'],o2=m['Coolant temperature outlet2'];\nconst d1=m['Coolant deltaT1'],d2=m['Coolant deltaT2'];\nconst lv=m['Coolant level'],lk=m['LEAK detection'];\nconst ct=m['Air temperature'],ch=m['Air humidity'];\n\nsetEl('sv-in1','Inlet 1: '+fmt(i1)+'\\u00b0C',evalInlet(i1));\nsetEl('sv-in2','Inlet 2: '+fmt(i2)+'\\u00b0C',evalInlet(i2));\nsetEl('sv-out1','Outlet 1: '+fmt(o1)+'\\u00b0C',evalOutlet(o1));\nsetEl('sv-out2','Outlet 2: '+fmt(o2)+'\\u00b0C',evalOutlet(o2));\nsetEl('sv-dt1',fmt(d1)+'\\u00b0C',evalDelta(d1));\nsetEl('sv-dt2',fmt(d2)+'\\u00b0C',evalDelta(d2));\nsetEl('sv-leak',lk===1?'LEAKED':'NORMAL',lk===1?'critical':'normal');\nsetEl('sv-lev','Coolant Level: '+(lv===1?'HIGH':'LOW'),lv===0?'critical':'normal');\nsetEl('sv-ct',fmt(ct)+'\\u00b0C',evalChasT(ct));\nsetEl('sv-ch',fmt(ch)+'%',evalChasH(ch));",
        "onInit": ""
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant.*|LEAK.*|Air.*\"}",
          "instant": true,
          "legendFormat": "{{metric}}",
          "refId": "A"
        }
      ],
      "title": "Cooling Health",
      "type": "gapit-htmlgraphics-panel"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "gridPos": {
        "h": 20,
        "w": 11,
        "x": 7,
        "y": 14
      },
      "id": 6,
      "options": {
        "SVGBaseFix": true,
        "add100Percentage": true,
        "centerAlignContent": false,
        "overflow": "auto",
        "css": "* { box-sizing: border-box; margin: 0; padding: 0; }\n.compute { width: 100%; height: 100%; padding: 10px; font-family: Inter, sans-serif; color: #fff; display: flex; flex-direction: column; gap: 6px; }\n.toolbar { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; padding: 5px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }\n.toolbar.sub { padding: 3px 0 3px 10px; border-bottom: 1px solid rgba(255,255,255,0.05); }\n.toolbar label { font-size: 12px; color: #fff; display: flex; align-items: center; gap: 4px; cursor: pointer; }\n.toolbar.sub label { font-size: 11px; }\n.toolbar input[type=radio],\n.toolbar input[type=checkbox] { accent-color: #4A9BF5; cursor: pointer; width: 13px; height: 13px; }\n.tl { font-size: 11px; color: rgba(255,255,255,0.5); }\n.tb-sep { color: #555; margin: 0 4px; }\n.cards { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; padding-top: 6px; }\n.card { background: rgba(255,255,255,0.04); border-radius: 6px; padding: 10px; }\n.card h4 { font-size: 13px; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; color: #fff; opacity: 0.7; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 5px; }\n.tbl { width: 100%; border-collapse: collapse; font-size: 13px; }\n.tbl th { text-align: left; font-weight: 600; padding: 4px 8px; color: #fff; opacity: 0.6; font-size: 12px; border-bottom: 1px solid rgba(255,255,255,0.1); }\n.tbl td { padding: 4px 8px; font-variant-numeric: tabular-nums; color: #fff; }\n.tbl td.normal { color: #fff; }\n.tbl td.warning { color: #FADE2A; }\n.tbl td.critical { color: #F2495C; }\n.bar-legend { display: flex; gap: 12px; margin-bottom: 6px; flex-wrap: wrap; }\n.bar-lg { display: flex; align-items: center; gap: 5px; font-size: 11px; color: rgba(255,255,255,0.7); }\n.bar-swatch { width: 10px; height: 10px; border-radius: 2px; display: inline-block; }\n.bar-group-label { font-size: 12px; color: rgba(255,255,255,0.6); margin: 8px 0 3px 0; font-weight: 600; }\n.bar-row { display: flex; align-items: center; margin: 3px 0; }\n.bar-label { width: 80px; font-size: 11px; color: rgba(255,255,255,0.7); flex-shrink: 0; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }\n.bar-track { flex: 1; height: 16px; background: rgba(255,255,255,0.06); border-radius: 3px; position: relative; overflow: hidden; }\n.bar-fill { height: 100%; border-radius: 3px; position: absolute; left: 0; top: 0; }\n.bar-val { font-size: 11px; width: 65px; text-align: right; flex-shrink: 0; margin-left: 6px; font-variant-numeric: tabular-nums; }\n.bar-val.normal { color: #fff; }\n.bar-val.warning { color: #FADE2A; }\n.bar-val.critical { color: #F2495C; }\n.util-line { margin-top: 8px; padding: 6px 8px; font-size: 13px; color: #fff; background: rgba(255,255,255,0.04); border-radius: 4px; }",
        "html": "<div class='compute'>\n  <div class='toolbar'>\n    <span class='tl'>View:</span>\n    <label><input type='radio' name='viewMode' value='table' checked/> Table</label>\n    <label><input type='radio' name='viewMode' value='bar'/> Bar</label>\n    <span class='tb-sep'>|</span>\n    <span class='tl'>Group:</span>\n    <label><input type='radio' name='groupBy' value='device' checked/> Device</label>\n    <label><input type='radio' name='groupBy' value='metric'/> Metric</label>\n    <span class='tb-sep'>|</span>\n    <span class='tl'>Show:</span>\n    <label><input type='checkbox' id='cb-gpu' checked/> AI Proc</label>\n    <label><input type='checkbox' id='cb-cpu' checked/> CPU</label>\n    <label><input type='checkbox' id='cb-mem' checked/> Mem</label>\n  </div>\n  <div class='toolbar sub' id='gpu-metrics'>\n    <span class='tl'>AI Proc:</span>\n    <label><input type='checkbox' id='gm-temp' checked/> Temp</label>\n    <label><input type='checkbox' id='gm-power' checked/> Power</label>\n    <label><input type='checkbox' id='gm-core' checked/> Core%</label>\n    <label><input type='checkbox' id='gm-mem' checked/> Mem%</label>\n  </div>\n  <div class='toolbar sub' id='cpu-metrics'>\n    <span class='tl'>CPU:</span>\n    <label><input type='checkbox' id='cm-temp' checked/> Temp</label>\n    <label><input type='checkbox' id='cm-power' checked/> Power</label>\n    <label><input type='checkbox' id='cm-util' checked/> Util%</label>\n  </div>\n  <div class='toolbar sub' id='mem-metrics'>\n    <span class='tl'>Memory:</span>\n    <label><input type='checkbox' id='mm-avail' checked/> Avail%</label>\n    <label><input type='checkbox' id='mm-used' checked/> Used</label>\n    <label><input type='checkbox' id='mm-swap' checked/> Swap</label>\n    <label><input type='checkbox' id='mm-oom' checked/> OOM</label>\n  </div>\n  <div class='cards' id='content-area'>Loading...</div>\n</div>",
        "onInit": "htmlNode._doRender=function(data){\nvar m={};\ndata.series.forEach(function(s){if(!s.fields||s.fields.length<2)return;var f=s.fields[1];var metric=(f.labels||{}).metric||'';var vals=f.values;if(vals&&vals.length>0)m[metric]=vals[vals.length-1];});\nfunction fmt(v,d){return v!==undefined&&v!==null?Number(v).toFixed(d!==undefined?d:1):'-';}\nfunction evalGpuT(v){if(v===undefined)return'normal';if(v>90)return'critical';if(v>75)return'warning';return'normal';}\nfunction evalCpuT(v){if(v===undefined)return'normal';if(v>95)return'critical';if(v>85)return'warning';return'normal';}\nfunction evalMemA(p){if(p===undefined)return'normal';if(p<10)return'critical';if(p<20)return'warning';return'normal';}\nfunction evalSwap(v){if(v===undefined)return'normal';if(v>0)return'warning';return'normal';}\nfunction evalOom(v){if(v===undefined)return'normal';if(v>=1)return'critical';return'normal';}\nvar isBar=(htmlNode.querySelector('input[name=viewMode]:checked')||{}).value==='bar';\nvar groupBy=(htmlNode.querySelector('input[name=groupBy]:checked')||{}).value||'device';\nvar showGpu=htmlNode.querySelector('#cb-gpu')?htmlNode.querySelector('#cb-gpu').checked:true;\nvar showCpu=htmlNode.querySelector('#cb-cpu')?htmlNode.querySelector('#cb-cpu').checked:true;\nvar showMem=htmlNode.querySelector('#cb-mem')?htmlNode.querySelector('#cb-mem').checked:true;\nfunction chk(id){var e=htmlNode.querySelector('#'+id);return e?e.checked:true;}\nvar gpuMbar=htmlNode.querySelector('#gpu-metrics');\nvar cpuMbar=htmlNode.querySelector('#cpu-metrics');\nvar memMbar=htmlNode.querySelector('#mem-metrics');\nif(gpuMbar)gpuMbar.style.display=showGpu?'':'none';\nif(cpuMbar)cpuMbar.style.display=showCpu?'':'none';\nif(memMbar)memMbar.style.display=showMem?'':'none';\nvar gpus={};\nObject.keys(m).forEach(function(k){var x;\nif(x=k.match(/^(.+) asic temperature$/)){gpus[x[1]]=gpus[x[1]]||{};gpus[x[1]].temp=m[k];}\nif(x=k.match(/^(.+) current power usage$/)){gpus[x[1]]=gpus[x[1]]||{};gpus[x[1]].power=m[k];}\nif(x=k.match(/^(.+) Max power limit$/)){gpus[x[1]]=gpus[x[1]]||{};gpus[x[1]].maxPwr=m[k];}\nif(x=k.match(/^(.+) core utilization$/)){gpus[x[1]]=gpus[x[1]]||{};gpus[x[1]].coreU=m[k];}\nif(x=k.match(/^(.+) memory utilization$/)){gpus[x[1]]=gpus[x[1]]||{};gpus[x[1]].memU=m[k];}\n});\nvar cpuD={};\nObject.keys(m).forEach(function(k){var x;\nif(x=k.match(/^(CPU\\d+) temperature$/)){cpuD[x[1]]=cpuD[x[1]]||{};cpuD[x[1]].temp=m[k];}\nif(x=k.match(/^(CPU\\d+) power usage$/)){cpuD[x[1]]=cpuD[x[1]]||{};cpuD[x[1]].power=m[k];}\n});\nvar cpuU=m['CPU Usage'];\nObject.keys(cpuD).forEach(function(k){cpuD[k].util=cpuU;});\nvar mT=m['Memory_total'],mU=m['Memory_usage'],mA=m['Memory_available'];\nvar swV=m['Swap_usage'],oomV=m['OOM_count'];\nvar maPct=mT&&mA?(mA/mT*100):undefined;\nvar bMax={gt:99,gp:770,gc:110,gm:110,ct:104.5,cp:330,cu:110,ma:110,mu:(mT||512)*1.1,ms:110,mo:11};\nvar bClr={temp:'#4A9BF5',power:'#73BF69',coreU:'#FF9830',memU:'#B877D9',util:'#FFD664'};\nvar content=htmlNode.querySelector('#content-area');if(!content)return;\nvar h='';\nfunction barRow(lb,val,unit,max,color,ev){\nvar pct=(val!==undefined&&val!==null&&max)?Math.min(Math.abs(val)/max*100,100):0;\nvar cls=ev?ev(val):'normal';\nvar clr=cls==='critical'?'#F2495C':cls==='warning'?'#FADE2A':color;\nreturn '<div class=\"bar-row\"><span class=\"bar-label\">'+lb+'</span><div class=\"bar-track\"><div class=\"bar-fill\" style=\"width:'+pct+'%;background:'+clr+'\"></div></div><span class=\"bar-val '+cls+'\">'+fmt(val)+unit+'</span></div>';}\nif(!isBar){\nif(groupBy==='device'){\nif(showGpu){h+='<div class=\"card\"><h4>AI Processors</h4>';\nvar gc=[];\nif(chk('gm-temp'))gc.push({k:'temp',l:'Temp',u:'\\u00b0C',ev:evalGpuT});\nif(chk('gm-power'))gc.push({k:'power',l:'Power',u:'W',ev:null});\nif(chk('gm-core'))gc.push({k:'coreU',l:'Core%',u:'%',ev:null});\nif(chk('gm-mem'))gc.push({k:'memU',l:'Mem%',u:'%',ev:null});\nh+='<table class=\"tbl\"><tr><th>Device</th>';gc.forEach(function(c){h+='<th>'+c.l+'</th>';});h+='</tr>';\nvar gk=Object.keys(gpus).sort();\ngk.forEach(function(n){var g=gpus[n];h+='<tr><td>'+n+'</td>';\ngc.forEach(function(c){var v=g[c.k];var cl=c.ev?c.ev(v):'normal';h+='<td class=\"'+cl+'\">'+fmt(v)+c.u+'</td>';});h+='</tr>';});\nif(!gk.length)h+='<tr><td colspan=\"'+(gc.length+1)+'\" style=\"color:#666\">No data</td></tr>';\nh+='</table></div>';}\nif(showCpu){h+='<div class=\"card\"><h4>CPUs</h4>';\nvar cc=[];\nif(chk('cm-temp'))cc.push({k:'temp',l:'Temp',u:'\\u00b0C',ev:evalCpuT});\nif(chk('cm-power'))cc.push({k:'power',l:'Power',u:'W',ev:null});\nif(chk('cm-util'))cc.push({k:'util',l:'Util%',u:'%',ev:null});\nh+='<table class=\"tbl\"><tr><th>Device</th>';cc.forEach(function(c){h+='<th>'+c.l+'</th>';});h+='</tr>';\nvar ck=Object.keys(cpuD).sort();\nck.forEach(function(n){var c2=cpuD[n];h+='<tr><td>'+n+'</td>';\ncc.forEach(function(c){var v=c2[c.k];var cl=c.ev?c.ev(v):'normal';h+='<td class=\"'+cl+'\">'+fmt(v)+c.u+'</td>';});h+='</tr>';});\nif(!ck.length)h+='<tr><td colspan=\"'+(cc.length+1)+'\" style=\"color:#666\">No data</td></tr>';\nh+='</table></div>';}\nif(showMem){h+='<div class=\"card\"><h4>Memory</h4><table class=\"tbl\">';\nif(chk('mm-avail'))h+='<tr><td>Available</td><td class=\"'+evalMemA(maPct)+'\">'+fmt(maPct)+'%</td></tr>';\nif(chk('mm-used'))h+='<tr><td>Used</td><td class=\"normal\">'+fmt(mU)+' GB</td></tr>';\nif(chk('mm-swap'))h+='<tr><td>Swap</td><td class=\"'+evalSwap(swV)+'\">'+fmt(swV)+' GB</td></tr>';\nif(chk('mm-oom'))h+='<tr><td>OOM Count</td><td class=\"'+evalOom(oomV)+'\">'+(oomV!==undefined?oomV:'-')+'</td></tr>';\nh+='</table></div>';}\n}else{\nif(showGpu){h+='<div class=\"card\"><h4>AI Processors</h4>';\nvar gk=Object.keys(gpus).sort();\nh+='<table class=\"tbl\"><tr><th>Metric</th>';gk.forEach(function(n){h+='<th>'+n.replace(/.*_/,'#')+'</th>';});h+='</tr>';\nvar gm=[];\nif(chk('gm-temp'))gm.push({k:'temp',l:'Temp',u:'\\u00b0C',ev:evalGpuT});\nif(chk('gm-power'))gm.push({k:'power',l:'Power',u:'W',ev:null});\nif(chk('gm-core'))gm.push({k:'coreU',l:'Core%',u:'%',ev:null});\nif(chk('gm-mem'))gm.push({k:'memU',l:'Mem%',u:'%',ev:null});\ngm.forEach(function(r){h+='<tr><td>'+r.l+'</td>';\ngk.forEach(function(n){var v=gpus[n][r.k];var cl=r.ev?r.ev(v):'normal';h+='<td class=\"'+cl+'\">'+fmt(v)+r.u+'</td>';});h+='</tr>';});\nif(!gk.length)h+='<tr><td colspan=\"2\" style=\"color:#666\">No data</td></tr>';\nh+='</table></div>';}\nif(showCpu){h+='<div class=\"card\"><h4>CPUs</h4>';\nvar ck=Object.keys(cpuD).sort();\nh+='<table class=\"tbl\"><tr><th>Metric</th>';ck.forEach(function(n){h+='<th>'+n+'</th>';});h+='</tr>';\nvar cm=[];\nif(chk('cm-temp'))cm.push({k:'temp',l:'Temp',u:'\\u00b0C',ev:evalCpuT});\nif(chk('cm-power'))cm.push({k:'power',l:'Power',u:'W',ev:null});\nif(chk('cm-util'))cm.push({k:'util',l:'Util%',u:'%',ev:null});\ncm.forEach(function(r){h+='<tr><td>'+r.l+'</td>';\nck.forEach(function(n){var v=cpuD[n][r.k];var cl=r.ev?r.ev(v):'normal';h+='<td class=\"'+cl+'\">'+fmt(v)+r.u+'</td>';});h+='</tr>';});\nif(!ck.length)h+='<tr><td colspan=\"2\" style=\"color:#666\">No data</td></tr>';\nh+='</table></div>';}\nif(showMem){h+='<div class=\"card\"><h4>Memory</h4><table class=\"tbl\">';\nif(chk('mm-avail'))h+='<tr><td>Available</td><td class=\"'+evalMemA(maPct)+'\">'+fmt(maPct)+'%</td></tr>';\nif(chk('mm-used'))h+='<tr><td>Used</td><td class=\"normal\">'+fmt(mU)+' GB</td></tr>';\nif(chk('mm-swap'))h+='<tr><td>Swap</td><td class=\"'+evalSwap(swV)+'\">'+fmt(swV)+' GB</td></tr>';\nif(chk('mm-oom'))h+='<tr><td>OOM Count</td><td class=\"'+evalOom(oomV)+'\">'+(oomV!==undefined?oomV:'-')+'</td></tr>';\nh+='</table></div>';}\n}\n}else{\nif(groupBy==='device'){\nif(showGpu){h+='<div class=\"card\"><h4>AI Processors</h4>';\nvar gm=[];\nif(chk('gm-temp'))gm.push({k:'temp',l:'Temp',u:'\\u00b0C',mx:bMax.gt,c:bClr.temp,ev:evalGpuT});\nif(chk('gm-power'))gm.push({k:'power',l:'Power',u:'W',mx:bMax.gp,c:bClr.power,ev:null});\nif(chk('gm-core'))gm.push({k:'coreU',l:'Core%',u:'%',mx:bMax.gc,c:bClr.coreU,ev:null});\nif(chk('gm-mem'))gm.push({k:'memU',l:'Mem%',u:'%',mx:bMax.gm,c:bClr.memU,ev:null});\nh+='<div class=\"bar-legend\">';gm.forEach(function(x){h+='<span class=\"bar-lg\"><span class=\"bar-swatch\" style=\"background:'+x.c+'\"></span>'+x.l+'</span>';});h+='</div>';\nObject.keys(gpus).sort().forEach(function(n){var g=gpus[n];h+='<div class=\"bar-group-label\">'+n+'</div>';\ngm.forEach(function(x){h+=barRow(x.l,g[x.k],x.u,x.mx,x.c,x.ev);});});\nh+='</div>';}\nif(showCpu){h+='<div class=\"card\"><h4>CPUs</h4>';\nvar cm=[];\nif(chk('cm-temp'))cm.push({k:'temp',l:'Temp',u:'\\u00b0C',mx:bMax.ct,c:bClr.temp,ev:evalCpuT});\nif(chk('cm-power'))cm.push({k:'power',l:'Power',u:'W',mx:bMax.cp,c:bClr.power,ev:null});\nif(chk('cm-util'))cm.push({k:'util',l:'Util%',u:'%',mx:bMax.cu,c:bClr.util,ev:null});\nh+='<div class=\"bar-legend\">';cm.forEach(function(x){h+='<span class=\"bar-lg\"><span class=\"bar-swatch\" style=\"background:'+x.c+'\"></span>'+x.l+'</span>';});h+='</div>';\nObject.keys(cpuD).sort().forEach(function(n){var c2=cpuD[n];h+='<div class=\"bar-group-label\">'+n+'</div>';\ncm.forEach(function(x){h+=barRow(x.l,c2[x.k],x.u,x.mx,x.c,x.ev);});});\nh+='</div>';}\nif(showMem){h+='<div class=\"card\"><h4>Memory</h4>';\nif(chk('mm-avail'))h+=barRow('Available',maPct,'%',bMax.ma,bClr.temp,evalMemA);\nif(chk('mm-used'))h+=barRow('Used',mU,' GB',bMax.mu,bClr.power,null);\nif(chk('mm-swap'))h+=barRow('Swap',swV,' GB',bMax.ms,'#FF9830',evalSwap);\nif(chk('mm-oom'))h+=barRow('OOM',oomV,'',bMax.mo,'#F2495C',evalOom);\nh+='</div>';}\n}else{\nif(showGpu){h+='<div class=\"card\"><h4>AI Processors</h4>';\nvar gm=[];\nif(chk('gm-temp'))gm.push({k:'temp',l:'Temperature',u:'\\u00b0C',mx:bMax.gt,c:bClr.temp,ev:evalGpuT});\nif(chk('gm-power'))gm.push({k:'power',l:'Power',u:'W',mx:bMax.gp,c:bClr.power,ev:null});\nif(chk('gm-core'))gm.push({k:'coreU',l:'Core Util',u:'%',mx:bMax.gc,c:bClr.coreU,ev:null});\nif(chk('gm-mem'))gm.push({k:'memU',l:'Mem Util',u:'%',mx:bMax.gm,c:bClr.memU,ev:null});\nvar gk=Object.keys(gpus).sort();\ngm.forEach(function(x){h+='<div class=\"bar-group-label\">'+x.l+'</div>';\ngk.forEach(function(n){h+=barRow(n,gpus[n][x.k],x.u,x.mx,x.c,x.ev);});});\nh+='</div>';}\nif(showCpu){h+='<div class=\"card\"><h4>CPUs</h4>';\nvar cm=[];\nif(chk('cm-temp'))cm.push({k:'temp',l:'Temperature',u:'\\u00b0C',mx:bMax.ct,c:bClr.temp,ev:evalCpuT});\nif(chk('cm-power'))cm.push({k:'power',l:'Power',u:'W',mx:bMax.cp,c:bClr.power,ev:null});\nif(chk('cm-util'))cm.push({k:'util',l:'Utilization',u:'%',mx:bMax.cu,c:bClr.util,ev:null});\nvar ck=Object.keys(cpuD).sort();\ncm.forEach(function(x){h+='<div class=\"bar-group-label\">'+x.l+'</div>';\nck.forEach(function(n){h+=barRow(n,cpuD[n][x.k],x.u,x.mx,x.c,x.ev);});});\nh+='</div>';}\nif(showMem){h+='<div class=\"card\"><h4>Memory</h4>';\nif(chk('mm-avail')){h+='<div class=\"bar-group-label\">Available</div>';h+=barRow('Memory',maPct,'%',bMax.ma,bClr.temp,evalMemA);}\nif(chk('mm-used')){h+='<div class=\"bar-group-label\">Used</div>';h+=barRow('Memory',mU,' GB',bMax.mu,bClr.power,null);}\nif(chk('mm-swap')){h+='<div class=\"bar-group-label\">Swap</div>';h+=barRow('Memory',swV,' GB',bMax.ms,'#FF9830',evalSwap);}\nif(chk('mm-oom')){h+='<div class=\"bar-group-label\">OOM Count</div>';h+=barRow('Memory',oomV,'',bMax.mo,'#F2495C',evalOom);}\nh+='</div>';}\n}}\ncontent.innerHTML=h;\n};\nhtmlNode.querySelectorAll('input[type=radio],input[type=checkbox]').forEach(function(inp){\ninp.addEventListener('change',function(){if(htmlNode._lastData)htmlNode._doRender(htmlNode._lastData);});\n});",
        "onRender": "htmlNode._lastData=data;\nif(htmlNode._doRender)htmlNode._doRender(data);"
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"CPU.*|.*asic temperature|.*power usage|.*utilization|.*power limit|Memory.*|Swap.*|OOM.*\"}",
          "instant": true,
          "legendFormat": "{{metric}}",
          "refId": "A"
        }
      ],
      "title": "Compute Health",
      "type": "gapit-htmlgraphics-panel"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "gridPos": {
        "h": 20,
        "w": 6,
        "x": 18,
        "y": 14
      },
      "id": 7,
      "options": {
        "SVGBaseFix": true,
        "add100Percentage": true,
        "centerAlignContent": false,
        "overflow": "auto",
        "css": "* { box-sizing: border-box; margin: 0; padding: 0; }\n.network { width: 100%; height: 100%; padding: 14px; font-family: Inter, sans-serif; color: #fff; display: flex; flex-direction: column; gap: 14px; }\n.net-card { background: rgba(255,255,255,0.04); border-radius: 6px; padding: 14px; }\n.net-card h4 { font-size: 14px; text-transform: uppercase; letter-spacing: 1px; color: #fff; opacity: 0.7; margin-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 5px; }\n.net-row { display: flex; justify-content: space-between; padding: 6px 0; font-size: 15px; color: #fff; }\n.net-row .lb { opacity: 0.7; }\n.net-row .vl { font-weight: 700; font-variant-numeric: tabular-nums; }\n.vl.normal { color: #fff; }\n.vl.warning { color: #FADE2A; }\n.vl.critical { color: #F2495C; }\n.status-indicator { display: inline-block; width: 10px; height: 10px; border-radius: 50%; margin-right: 6px; }\n.status-indicator.up { background: #73BF69; }\n.status-indicator.down { background: #F2495C; }",
        "html": "<div class='network'>\n  <div class='net-card'>\n    <h4>Link Status</h4>\n    <div class='net-row'>\n      <span class='lb'>Status</span>\n      <span class='vl' id='n-link'><span class='status-indicator'></span>-</span>\n    </div>\n  </div>\n  <div class='net-card'>\n    <h4>Throughput</h4>\n    <div class='net-row'>\n      <span class='lb'>TX</span>\n      <span class='vl normal' id='n-tx'>-</span>\n    </div>\n    <div class='net-row'>\n      <span class='lb'>RX</span>\n      <span class='vl normal' id='n-rx'>-</span>\n    </div>\n  </div>\n  <div class='net-card'>\n    <h4>Errors / Drops</h4>\n    <div class='net-row'>\n      <span class='lb'>Error Rate</span>\n      <span class='vl' id='n-err'>-</span>\n    </div>\n    <div class='net-row'>\n      <span class='lb'>Drop Rate</span>\n      <span class='vl' id='n-drop'>-</span>\n    </div>\n  </div>\n</div>",
        "onRender": "const m={};\ndata.series.forEach(s=>{\n  if(!s.fields||s.fields.length<2)return;\n  const f=s.fields[1];\n  const metric=(f.labels||{}).metric||'';\n  const vals=f.values;\n  if(vals&&vals.length>0) m[metric]=vals[vals.length-1];\n});\n\nfunction fmt(v,d){return v!==undefined&&v!==null?Number(v).toFixed(d!==undefined?d:4):'-';}\nfunction el(id){return htmlNode.querySelector('#'+id);}\n\nconst link=m['Network link status'];\nconst tx=m['Network TX throughput'];\nconst rx=m['Network RX throughput'];\nconst err=m['Network errors rate'];\nconst drop=m['Network drops rate'];\n\nconst linkEl=el('n-link');\nif(linkEl){\n  if(link===1) linkEl.innerHTML='<span class=\"status-indicator up\"></span><span class=\"vl normal\">UP</span>';\n  else if(link===0) linkEl.innerHTML='<span class=\"status-indicator down\"></span><span class=\"vl critical\">DOWN</span>';\n  else linkEl.innerHTML='-';\n}\n\nconst txEl=el('n-tx');if(txEl){txEl.textContent=fmt(tx,4)+' Gbps';txEl.className='vl normal';}\nconst rxEl=el('n-rx');if(rxEl){rxEl.textContent=fmt(rx,4)+' Gbps';rxEl.className='vl normal';}\nconst errEl=el('n-err');if(errEl){errEl.textContent=fmt(err,4)+' %';errEl.className='vl normal';}\n\nconst dropEl=el('n-drop');\nif(dropEl){\n  dropEl.textContent=fmt(drop,4)+' %';\n  if(drop>=0.05) dropEl.className='vl critical';\n  else if(drop>0.01) dropEl.className='vl warning';\n  else dropEl.className='vl normal';\n}",
        "onInit": ""
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Network.*\"}",
          "instant": true,
          "legendFormat": "{{metric}}",
          "refId": "A"
        }
      ],
      "title": "Network Health",
      "type": "gapit-htmlgraphics-panel"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 34
      },
      "id": 8,
      "panels": [],
      "title": "History",
      "type": "row"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "dashed"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "#EAB839",
                "value": 40
              },
              {
                "color": "red",
                "value": 45
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": "/outlet/"
            },
            "properties": [
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "#EAB839",
                      "value": 60
                    },
                    {
                      "color": "red",
                      "value": 65
                    }
                  ]
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byRegexp",
              "options": "/deltaT/"
            },
            "properties": [
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "#EAB839",
                      "value": 15
                    },
                    {
                      "color": "red",
                      "value": 20
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 35
      },
      "id": 9,
      "options": {
        "legend": {
          "calcs": [
            "min",
            "max",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"Coolant temperature.*|Coolant deltaT.*\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "A"
        }
      ],
      "title": "Coolant Temperature",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "dashed"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "#EAB839",
                "value": 40
              },
              {
                "color": "red",
                "value": 50
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Air humidity"
            },
            "properties": [
              {
                "id": "custom.axisPlacement",
                "value": "right"
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "red",
                      "value": null
                    },
                    {
                      "color": "#EAB839",
                      "value": 10
                    },
                    {
                      "color": "green",
                      "value": 20
                    },
                    {
                      "color": "#EAB839",
                      "value": 60
                    },
                    {
                      "color": "red",
                      "value": 80
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 35
      },
      "id": 10,
      "options": {
        "legend": {
          "calcs": [
            "min",
            "max",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air temperature\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Air humidity\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "Chassis Temperature & Humidity",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "dashed"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "#EAB839",
                "value": 85
              },
              {
                "color": "red",
                "value": 95
              }
            ]
          },
          "unit": "celsius"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": "/asic temperature/"
            },
            "properties": [
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "#EAB839",
                      "value": 75
                    },
                    {
                      "color": "red",
                      "value": 90
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 43
      },
      "id": 11,
      "options": {
        "legend": {
          "calcs": [
            "min",
            "max",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"CPU[0-9]+ temperature\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\".*asic temperature\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "CPU & AI Processor Temperature",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 600
              }
            ]
          },
          "unit": "watt"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 43
      },
      "id": 12,
      "options": {
        "legend": {
          "calcs": [
            "min",
            "max",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\"CPU[0-9]+ power usage\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\".*current power usage\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "CPU & AI Processor Power Usage",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "#EAB839",
                "value": 80
              },
              {
                "color": "red",
                "value": 95
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 51
      },
      "id": 13,
      "options": {
        "legend": {
          "calcs": [
            "min",
            "max",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"CPU Usage\"}",
          "legendFormat": "CPU Usage",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\".*core utilization\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=~\".*memory utilization\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "C"
        }
      ],
      "title": "Utilization",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "decgbytes"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Swap_usage"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 15
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 51
      },
      "id": 14,
      "options": {
        "legend": {
          "calcs": [
            "min",
            "max",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Memory_total\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Memory_usage\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "B"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Memory_available\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "C"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Swap_usage\"}",
          "legendFormat": "{{metric}}",
          "range": true,
          "refId": "D"
        }
      ],
      "title": "Memory & Swap",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "Gbps"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 59
      },
      "id": 15,
      "options": {
        "legend": {
          "calcs": [
            "min",
            "max",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Network TX throughput\"}",
          "legendFormat": "TX",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Network RX throughput\"}",
          "legendFormat": "RX",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "Network Throughput",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${datasource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 0,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "dashed"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "#EAB839",
                "value": 0.01
              },
              {
                "color": "red",
                "value": 0.05
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 59
      },
      "id": 16,
      "options": {
        "legend": {
          "calcs": [
            "min",
            "max",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Network errors rate\"}",
          "legendFormat": "Errors",
          "range": true,
          "refId": "A"
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${datasource}"
          },
          "editorMode": "code",
          "expr": "DLC_sensors_gauge{server_name=\"dg5R\", metric=\"Network drops rate\"}",
          "legendFormat": "Drops",
          "range": true,
          "refId": "B"
        }
      ],
      "title": "Network Errors & Drops",
      "type": "timeseries"
    }
  ],
  "refresh": "10s",
  "schemaVersion": 39,
  "tags": [
    "dg5R",
    "DLC"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "hide": 2,
        "includeAll": false,
        "label": "datasource",
        "multi": false,
        "name": "datasource",
        "options": [],
        "query": "prometheus",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      }
    ]
  },
  "time": {
    "from": "now-5m",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "browser",
  "title": "dg5R Dashboard",
  "uid": "dg5R-dashboard-v1",
  "version": 4,
  "weekStart": ""
}